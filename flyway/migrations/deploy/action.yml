name: 'Flyway Migrations Deployment Action'
description: 'A GitHub Action to deploy your Flyway migrations to a target database'
author: 'Redgate'

branding:
  icon: 'database'
  color: 'red'

inputs:
  target-environment:
    description: 'Target database to deploy to'
    required: false
    default: 'default'
  target-url:
    description: 'JDBC URL for the target database to deploy to'
    required: false
  target-user:
    description: 'Database user for the target database to deploy to'
    required: false
  target-password:
    description: 'Database password for the target database to deploy to'
    required: false
  target:
    description: 'Migrate up to this version'
    required: false
  cherry-pick:
    description: 'Comma-separated list of migration versions to deploy'
    required: false
  skip-drift:
    description: 'Skip the drift check'
    required: false
    default: 'false'
  working-directory:
    description: 'Working directory for Flyway'
    required: false
  extra-args:
    description: 'Additional arguments to pass to Flyway'
    required: false

outputs:
  exit-code:
    description: 'Flyway exit code'
  drift-detected:
    description: 'Whether drift was detected (empty if skipped)'
  migrations-applied:
    description: 'Number of migrations applied'
  schema-version:
    description: 'Schema version after deployment'

runs:
  using: 'node24'
  main: 'dist/index.js'
